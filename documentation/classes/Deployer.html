<!DOCTYPE html><html xmlns:date="http://exslt.org/dates-and-times" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
<meta charset="utf-8">
<title>phpDocumentor » \Deployer</title>
<meta name="author" content="Mike van Riel">
<meta name="description" content="">
<link href="../css/template.css" rel="stylesheet" media="all">
<script src="../js/jquery-1.7.1.min.js" type="text/javascript"></script><script src="../js/jquery-ui-1.8.2.custom.min.js" type="text/javascript"></script><script src="../js/jquery.mousewheel.min.js" type="text/javascript"></script><script src="../js/bootstrap.js" type="text/javascript"></script><script src="../js/template.js" type="text/javascript"></script><script src="../js/prettify/prettify.min.js" type="text/javascript"></script><link rel="shortcut icon" href="../img/favicon.ico">
<link rel="apple-touch-icon" href="../img/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="72x72" href="../img/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="114x114" href="../img/apple-touch-icon-114x114.png">
</head>
<body>
<div class="navbar navbar-fixed-top">
<div class="navbar-inner"><div class="container">
<a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse"><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></a><a class="brand" href="../index.html">phpDocumentor</a><div class="nav-collapse"><ul class="nav">
<li class="dropdown">
<a href="#api" class="dropdown-toggle" data-toggle="dropdown">
                                    API Documentation <b class="caret"></b></a><ul class="dropdown-menu">
<li><a>Packages</a></li>
<li><a href="../packages/Nedstars.html"><i class="icon-folder-open"></i> Nedstars</a></li>
<li><a href="../packages/Notifo.html"><i class="icon-folder-open"></i> Notifo</a></li>
<li><a href="../packages/Php-Pushover.html"><i class="icon-folder-open"></i> Php-Pushover</a></li>
</ul>
</li>
<li class="dropdown" id="charts-menu">
<a href="#charts" class="dropdown-toggle" data-toggle="dropdown">
                                    Charts <b class="caret"></b></a><ul class="dropdown-menu"><li><a href="../graph_class.html"><i class="icon-list-alt"></i> Class hierarchy diagram</a></li></ul>
</li>
<li class="dropdown" id="reports-menu">
<a href="#reports" class="dropdown-toggle" data-toggle="dropdown">
                                    Reports <b class="caret"></b></a><ul class="dropdown-menu">
<li><a href="../errors.html"><i class="icon-remove-sign"></i> Errors 
                <span class="label label-info">0</span></a></li>
<li><a href="../markers.html"><i class="icon-map-marker"></i> Markers 
                <ul><li>todo 
                <span class="label label-info">1</span>
</li></ul></a></li>
<li><a href="../deprecated.html"><i class="icon-stop"></i> Deprecated elements 
                <span class="label label-info">0</span></a></li>
</ul>
</li>
</ul></div>
</div></div>
<div class="go_to_top"><a href="#___" style="color: inherit">Back to top  <i class="icon-upload icon-white"></i></a></div>
</div>
<div id="___" class="container">
<noscript><div class="alert alert-warning">
                            Javascript is disabled; several features are only available
                            if Javascript is enabled.
                        </div></noscript>
<div class="row">
<div class="span4">
<span class="btn-group visibility" data-toggle="buttons-checkbox"><button class="btn public active" title="Show public elements">Public</button><button class="btn protected" title="Show protected elements">Protected</button><button class="btn private" title="Show private elements">Private</button><button class="btn inherited active" title="Show inherited elements">Inherited</button></span><div class="btn-group view pull-right" data-toggle="buttons-radio">
<button class="btn details" title="Show descriptions and method names"><i class="icon-list"></i></button><button class="btn simple" title="Show only method names"><i class="icon-align-justify"></i></button>
</div>
<ul class="side-nav nav nav-list">
<li class="nav-header">
<i class="icon-custom icon-method"></i> Methods</li>
<li class="method public "><a href="#__construct" title="__construct :: Constructor"><span class="description">Constructor</span><pre>__construct()</pre></a></li>
<li class="method public "><a href="#__destruct" title="__destruct :: Clean up locks"><span class="description">Clean up locks</span><pre>__destruct()</pre></a></li>
<li class="method public "><a href="#backupLive" title="backupLive :: Backup live dir into tar"><span class="description">Backup live dir into tar</span><pre>backupLive()</pre></a></li>
<li class="method public "><a href="#backupMysql" title="backupMysql :: Backup MySQL into tar in live dir"><span class="description">Backup MySQL into tar in live dir</span><pre>backupMysql()</pre></a></li>
<li class="method public "><a href="#clearData" title="clearData :: Logic for clearing data from new installation"><span class="description">Logic for clearing data from new installation</span><pre>clearData()</pre></a></li>
<li class="method public "><a href="#getGitSource" title="getGitSource :: Get data from Git"><span class="description">Get data from Git</span><pre>getGitSource()</pre></a></li>
<li class="method public "><a href="#preserveData" title="preserveData :: Logic for preserving  data"><span class="description">Logic for preserving  data</span><pre>preserveData()</pre></a></li>
<li class="method public "><a href="#printUsage" title="printUsage :: Print info on how to use the class"><span class="description">Print info on how to use the class</span><pre>printUsage()</pre></a></li>
<li class="method public "><a href="#printVersion" title="printVersion :: Print version info to terminal"><span class="description">Print version info to terminal</span><pre>printVersion()</pre></a></li>
<li class="method public "><a href="#purgeOldBackups" title="purgeOldBackups :: Delete old backups after N days"><span class="description">Delete old backups after N days</span><pre>purgeOldBackups()</pre></a></li>
<li class="method public "><a href="#sendNotifications" title="sendNotifications :: Send notification when backup is done"><span class="description">Send notification when backup is done</span><pre>sendNotifications()</pre></a></li>
<li class="method public "><a href="#setFolderPermisions" title="setFolderPermisions :: Set permisions to apache"><span class="description">Set permisions to apache</span><pre>setFolderPermisions()</pre></a></li>
<li class="method public "><a href="#switchLive" title="switchLive :: Clear temp_old dir
Copy current live to temp_old dir."><span class="description">Clear temp_old dir
Copy current live to temp_old dir.</span><pre>switchLive()</pre></a></li>
<li class="nav-header private">» Private</li>
<li class="method private "><a href="#_checkConfigurationValues" title="_checkConfigurationValues :: Check if configuration values are present and correct"><span class="description">Check if configuration values are present and correct</span><pre>_checkConfigurationValues()</pre></a></li>
<li class="method private "><a href="#_checkFreeDiskSpace" title="_checkFreeDiskSpace :: Check if there is 4 times the used diskpace free"><span class="description">Check if there is 4 times the used diskpace free</span><pre>_checkFreeDiskSpace()</pre></a></li>
<li class="method private "><a href="#_loadConfigFile" title='_loadConfigFile :: Load specified config file
Default config file is "deploy.conf.php"'><span class="description">Load specified config file
Default config file is "deploy.conf.php"</span><pre>_loadConfigFile()</pre></a></li>
<li class="method private "><a href="#_setLock" title="_setLock :: Set lock to prevent multiple instances on the same server"><span class="description">Set lock to prevent multiple instances on the same server</span><pre>_setLock()</pre></a></li>
<li class="method private "><a href="#_startLog" title="_startLog :: Make start log msg and set log level
NedStars_Log::setLogLevel($display_level);
NedStars_Log::startLog($start_msg);"><span class="description">Make start log msg and set log level
NedStars_Log::setLogLevel($display_level);
NedStars_Log::startLog($start_msg);</span><pre>_startLog()</pre></a></li>
<li class="method private "><a href="#_unsetLock" title="_unsetLock :: Relase the locking mechanism if set"><span class="description">Relase the locking mechanism if set</span><pre>_unsetLock()</pre></a></li>
<li class="method private "><a href="#_verifyMysqlCredentials" title="_verifyMysqlCredentials :: Verify MySQL credentials by making a connection to database"><span class="description">Verify MySQL credentials by making a connection to database</span><pre>_verifyMysqlCredentials()</pre></a></li>
<li class="method private "><a href="#_verifyRootUser" title="_verifyRootUser :: Verify if exec user is root"><span class="description">Verify if exec user is root</span><pre>_verifyRootUser()</pre></a></li>
<li class="nav-header">
<i class="icon-custom icon-property"></i> Properties</li>
<li class="property public "><a href="#%24input_option_array" title="$input_option_array :: PHP CLI arguments array."><span class="description">PHP CLI arguments array.</span><pre>$input_option_array</pre></a></li>
<li class="nav-header private">» Private</li>
<li class="property private "><a href="#%24_config" title="$_config :: Configuration object"><span class="description">Configuration object</span><pre>$_config</pre></a></li>
<li class="property private "><a href="#%24_lock" title="$_lock :: Contains the lock resources."><span class="description">Contains the lock resources.</span><pre>$_lock</pre></a></li>
<li class="nav-header">
<i class="icon-custom icon-constant"></i> Constants</li>
<li class="constant  "><a href="#VERSION" title="VERSION :: Script version"><span class="description">Script version</span><pre>VERSION</pre></a></li>
</ul>
</div>
<div class="span8">
<a name="%5CDeployer" id="\Deployer"></a><ul class="breadcrumb">
<li>
<a href="../index.html"><i class="icon-custom icon-class"></i></a><span class="divider">\</span>
</li>
<li><a href="../namespaces/global.html">global</a></li>
<li class="active">
<span class="divider">\</span><a href="../classes/Deployer.html">Deployer</a>
</li>
</ul>
<div href="../classes/Deployer.html" class="element class">
<p class="short_description">Deployer class, main deploy boject.</p>
<div class="details">
<p class="long_description"></p>
<table class="table table-bordered">
<tr>
<th>project</th>
<td>NedStars Deployer</td>
</tr>
<tr>
<th>category</th>
<td>Convenience_Class</td>
</tr>
<tr>
<th>package</th>
<td><a href="../packages/Nedstars.Deployer.html">Nedstars_Deployer</a></td>
</tr>
<tr>
<th>author</th>
<td><a href="mailto:alain@nedstars.nl">Alain Lecluse, Nedstars</a></td>
</tr>
<tr>
<th>copyright</th>
<td>2012  Nedstars &lt;info@nedstars.nl&gt;</td>
</tr>
</table>
<h3>
<i class="icon-custom icon-method"></i> Methods</h3>
<a name="__construct" id="__construct"></a><div class="element clickable method public __construct" data-toggle="collapse" data-target=".__construct .collapse">
<h2>Constructor</h2>
<pre>__construct(Array $options) : void</pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description">
<p class="long_description"><p>1) Parse arguments (done outside of the object)
2) set lock to prevent multiple instances
3) Load config
4) Init log level and set start msg
5) Check if required binairies exist
6) Check for free disk space
7) Sanity_info: check if all configuration options are filled in
    Check if user is root
    Check if mysql and git credentials are present</p></p>
<h3>Parameters</h3>
<div class="subelement argument">
<h4>$options</h4>
<code>Array</code><p>set options</p></div>
</div></div>
</div>
<a name="__destruct" id="__destruct"></a><div class="element clickable method public __destruct" data-toggle="collapse" data-target=".__destruct .collapse">
<h2>Clean up locks</h2>
<pre>__destruct() : void</pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description"><p class="long_description"></p></div></div>
</div>
<a name="backupLive" id="backupLive"></a><div class="element clickable method public backupLive" data-toggle="collapse" data-target=".backupLive .collapse">
<h2>Backup live dir into tar</h2>
<pre>backupLive() : void</pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description"><p class="long_description"></p></div></div>
</div>
<a name="backupMysql" id="backupMysql"></a><div class="element clickable method public backupMysql" data-toggle="collapse" data-target=".backupMysql .collapse">
<h2>Backup MySQL into tar in live dir</h2>
<pre>backupMysql() : void</pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description"><p class="long_description"></p></div></div>
</div>
<a name="clearData" id="clearData"></a><div class="element clickable method public clearData" data-toggle="collapse" data-target=".clearData .collapse">
<h2>Logic for clearing data from new installation</h2>
<pre>clearData() : void</pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description"><p class="long_description"></p></div></div>
</div>
<a name="getGitSource" id="getGitSource"></a><div class="element clickable method public getGitSource" data-toggle="collapse" data-target=".getGitSource .collapse">
<h2>Get data from Git</h2>
<pre>getGitSource() : void</pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description"><p class="long_description"></p></div></div>
</div>
<a name="preserveData" id="preserveData"></a><div class="element clickable method public preserveData" data-toggle="collapse" data-target=".preserveData .collapse">
<h2>Logic for preserving  data</h2>
<pre>preserveData() : void</pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description"><p class="long_description"></p></div></div>
</div>
<a name="printUsage" id="printUsage"></a><div class="element clickable method public printUsage" data-toggle="collapse" data-target=".printUsage .collapse">
<h2>Print info on how to use the class</h2>
<pre>printUsage() : void</pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description"><p class="long_description"></p></div></div>
</div>
<a name="printVersion" id="printVersion"></a><div class="element clickable method public printVersion" data-toggle="collapse" data-target=".printVersion .collapse">
<h2>Print version info to terminal</h2>
<pre>printVersion() : void</pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description"><p class="long_description"></p></div></div>
</div>
<a name="purgeOldBackups" id="purgeOldBackups"></a><div class="element clickable method public purgeOldBackups" data-toggle="collapse" data-target=".purgeOldBackups .collapse">
<h2>Delete old backups after N days</h2>
<pre>purgeOldBackups() : void</pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description"><p class="long_description"></p></div></div>
</div>
<a name="sendNotifications" id="sendNotifications"></a><div class="element clickable method public sendNotifications" data-toggle="collapse" data-target=".sendNotifications .collapse">
<h2>Send notification when backup is done</h2>
<pre>sendNotifications() : void</pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description"><p class="long_description"></p></div></div>
</div>
<a name="setFolderPermisions" id="setFolderPermisions"></a><div class="element clickable method public setFolderPermisions" data-toggle="collapse" data-target=".setFolderPermisions .collapse">
<h2>Set permisions to apache</h2>
<pre>setFolderPermisions() : void</pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description"><p class="long_description"></p></div></div>
</div>
<a name="switchLive" id="switchLive"></a><div class="element clickable method public switchLive" data-toggle="collapse" data-target=".switchLive .collapse">
<h2>Clear temp_old dir
Copy current live to temp_old dir.</h2>
<pre>switchLive() : void</pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description"><p class="long_description"><p>Copy new live from temp_new dir to live</p></p></div></div>
</div>
<a name="_checkConfigurationValues" id="_checkConfigurationValues"></a><div class="element clickable method private _checkConfigurationValues" data-toggle="collapse" data-target="._checkConfigurationValues .collapse">
<h2>Check if configuration values are present and correct</h2>
<pre>_checkConfigurationValues() : void</pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description"><p class="long_description"></p></div></div>
</div>
<a name="_checkFreeDiskSpace" id="_checkFreeDiskSpace"></a><div class="element clickable method private _checkFreeDiskSpace" data-toggle="collapse" data-target="._checkFreeDiskSpace .collapse">
<h2>Check if there is 4 times the used diskpace free</h2>
<pre>_checkFreeDiskSpace() : Boolean</pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description">
<p class="long_description"></p>
<h3>Returns</h3>
<div class="subelement response"><code>Boolean</code></div>
</div></div>
</div>
<a name="_loadConfigFile" id="_loadConfigFile"></a><div class="element clickable method private _loadConfigFile" data-toggle="collapse" data-target="._loadConfigFile .collapse">
<h2>Load specified config file
Default config file is "deploy.conf.php"</h2>
<pre>_loadConfigFile(array $options) : void</pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description">
<p class="long_description"></p>
<h3>Parameters</h3>
<div class="subelement argument">
<h4>$options</h4>
<code>array</code><p>set of posible overrides: branch, tag, config, debug</p></div>
</div></div>
</div>
<a name="_setLock" id="_setLock"></a><div class="element clickable method private _setLock" data-toggle="collapse" data-target="._setLock .collapse">
<h2>Set lock to prevent multiple instances on the same server</h2>
<pre>_setLock() : void</pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description">
<p class="long_description"><p>Uses stream socket server op port 12345 to lock</p></p>
<h3>Exceptions</h3>
<table class="table table-bordered">
<tr>
<th><code><a href="http://php.net/manual/en/class.exception.php">\Exception</a></code></th>
<td>when lock is allready set</td>
</tr>
<tr>
<th><code><a href="http://php.net/manual/en/class.exception.php">\Exception</a></code></th>
<td>when a other proces has the lock</td>
</tr>
</table>
</div></div>
</div>
<a name="_startLog" id="_startLog"></a><div class="element clickable method private _startLog" data-toggle="collapse" data-target="._startLog .collapse">
<h2>Make start log msg and set log level
NedStars_Log::setLogLevel($display_level);
NedStars_Log::startLog($start_msg);</h2>
<pre>_startLog(Array $options) : void</pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description">
<p class="long_description"></p>
<h3>Parameters</h3>
<div class="subelement argument">
<h4>$options</h4>
<code>Array</code><p>set of options, tag, branch, verbose</p></div>
</div></div>
</div>
<a name="_unsetLock" id="_unsetLock"></a><div class="element clickable method private _unsetLock" data-toggle="collapse" data-target="._unsetLock .collapse">
<h2>Relase the locking mechanism if set</h2>
<pre>_unsetLock() : void</pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description"><p class="long_description"></p></div></div>
</div>
<a name="_verifyMysqlCredentials" id="_verifyMysqlCredentials"></a><div class="element clickable method private _verifyMysqlCredentials" data-toggle="collapse" data-target="._verifyMysqlCredentials .collapse">
<h2>Verify MySQL credentials by making a connection to database</h2>
<pre>_verifyMysqlCredentials() : boolean</pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description">
<p class="long_description"></p>
<h3>Returns</h3>
<div class="subelement response">
<code>boolean</code>true</div>
</div></div>
</div>
<a name="_verifyRootUser" id="_verifyRootUser"></a><div class="element clickable method private _verifyRootUser" data-toggle="collapse" data-target="._verifyRootUser .collapse">
<h2>Verify if exec user is root</h2>
<pre>_verifyRootUser() : void</pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description"><p class="long_description"></p></div></div>
</div>
<h3>
<i class="icon-custom icon-property"></i> Properties</h3>
<a name="%24input_option_array" id="$input_option_array"> </a><div class="element clickable property public $input_option_array" data-toggle="collapse" data-target=".$input_option_array .collapse">
<h2>PHP CLI arguments array.</h2>
<pre>$input_option_array : Array</pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description"><p class="long_description"></p></div></div>
</div>
<a name="%24_config" id="$_config"> </a><div class="element clickable property private $_config" data-toggle="collapse" data-target=".$_config .collapse">
<h2>Configuration object</h2>
<pre>$_config : <a href="../classes/DeployConfig.html">\DeployConfig</a></pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description"><p class="long_description"></p></div></div>
</div>
<a name="%24_lock" id="$_lock"> </a><div class="element clickable property private $_lock" data-toggle="collapse" data-target=".$_lock .collapse">
<h2>Contains the lock resources.</h2>
<pre>$_lock : resource</pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description"><p class="long_description"></p></div></div>
</div>
<h3>
<i class="icon-custom icon-constant"></i> Constants</h3>
<a name="VERSION" id="VERSION"> </a><div class="element clickable constant  VERSION" data-toggle="collapse" data-target=".VERSION .collapse">
<h2>Script version</h2>
<pre>VERSION </pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description"><p class="long_description"></p></div></div>
</div>
</div>
</div>
</div>
</div>
<div class="row"><footer class="span12">
            Template is built using <a href="http://twitter.github.com/bootstrap/">Twitter Bootstrap 2</a> and icons provided by <a href="http://glyphicons.com/">Glyphicons</a>.<br>
            Documentation is powered by <a href="http://www.phpdoc.org/">phpDocumentor 2.0.0a8</a> and<br>
            generated on 2012-11-27T11:31:22+01:00.<br></footer></div>
</div>
</body>
</html>
